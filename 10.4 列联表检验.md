## 10.4 列联表检验

在本节中，介绍了拟合优度检验和列联表独立性检验（如表10.2）。对于离散随机变量 <img src="http://latex.codecogs.com/gif.latex?x\in\left\{1,\ldots,l\right\}" style="border:none;"> 和 <img src="http://latex.codecogs.com/gif.latex?y\in\left\{1,\ldots,m\right\}" style="border:none;"> ，从 <img src="http://latex.codecogs.com/gif.latex?p_{x,y}" style="border:none;"> 到 <img src="http://latex.codecogs.com/gif.latex?q_{x,y}" style="border:none;"> 的 *Pearson 散度* 被认为如下：  

 <img src="http://latex.codecogs.com/gif.latex?\sum_{x=1}^{l}\sum_{y=1}^{m}\frac{(p_{x,y}-q_{x,y})^{2}}{q_{x,y}}" style="border:none;">  <img src="http://latex.codecogs.com/gif.latex?(10.1)" style="border:none;"> 。  
 
![表10.2](表10.2.png)  

在拟合优度检验中，检验样本联合概率质量函数 <img src="http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{c_{x,y}}{n}" style="border:none;"> 等于目标值 <img src="http://latex.codecogs.com/gif.latex?f(x,y)" style="border:none;"> 的原假设。具体地，将关于  

<img src="http://latex.codecogs.com/gif.latex?p_{x,y}=\hat{f}(x,y)" style="border:none;"> ， <img src="http://latex.codecogs.com/gif.latex?q_{x,y}=f(x,y)" style="border:none;">

的 Pearson 散度 <img src="http://latex.codecogs.com/gif.latex?(10.1)" style="border:none;"> 用作检验统计量，并且基于 Pearson 散度服从自由度为 <img src="http://latex.codecogs.com/gif.latex?lm-1" style="border:none;"> 的卡方分布的事实来计算临界区。  

在独立性检验中，通过考虑样本联合概率质量函数 <img src="http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{c_{x,y}}{n}" style="border:none;"> 等于边际的乘积 <img src="http://latex.codecogs.com/gif.latex?\hat{g}(x)\hat{h}(y)" style="border:none;"> 的原假设来检验随机变量 <img src="http://latex.codecogs.com/gif.latex?x" style="border:none;"> 和 <img src="http://latex.codecogs.com/gif.latex?y" style="border:none;"> 之间的统计独立性，其中  

<img src="http://latex.codecogs.com/gif.latex?\hat{g}(x)=\frac{d_{x}}{n}=\frac{1}{n}\sum_{y=1}^{m}c_{x,y}" style="border:none;"> ，  
<img src="http://latex.codecogs.com/gif.latex?\hat{h}(y)=\frac{e_{y}}{n}=\frac{1}{n}\sum_{x=1}^{l}c_{x,y}" style="border:none;"> 。  

具体地，将关于  

<img src="http://latex.codecogs.com/gif.latex?p_{x,y}=\hat{f}(x,y)" style="border:none;">  ， <img src="http://latex.codecogs.com/gif.latex?q_{x,y}=\hat{g}(x)\hat{h}(y)" style="border:none;">  

的 Pearson 散度 <img src="http://latex.codecogs.com/gif.latex?(10.1)" style="border:none;"> 用作检验统计量，并且当 <img src="http://latex.codecogs.com/gif.latex?x" style="border:none;"> 和 <img src="http://latex.codecogs.com/gif.latex?y" style="border:none;"> 遵循多项分布时，基于 Pearson 散度服从自由度为 <img src="http://latex.codecogs.com/gif.latex?(l-1)(m-1)" style="border:none;"> 的卡方分布的事实来计算临界区。  

使用 *Kullback-Leibler（KL）发散* （见 <img src="http://latex.codecogs.com/gif.latex?14.2" style="border:none;"> 节）而非 Pearson 发散的检验，  

 <img src="http://latex.codecogs.com/gif.latex?\sum_{x=1}^{l}\sum_{y=1}^{m}p_{x,y}\log\frac{p_{x,y}}{q_{x,y}}" style="border:none;"> ，  
 
称为 *G-检验* 。这是一个似然比检验， KL 发散大致服从自由度为 <img src="http://latex.codecogs.com/gif.latex?(l-1)(m-1)" style="border:none;"> 的卡方分布。  

检验统计量（近似地）服从原假设下的卡方分布的检验称为 *卡方检验* 。

