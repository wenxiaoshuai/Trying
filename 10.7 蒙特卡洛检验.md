## 10.7 蒙特卡洛检验

上面引入的检验统计量（大致）服从原假设下的正态分布、t-分布和卡方分布。然而，如果一个检验统计量更复杂，其分布甚至不能被近似地解析导出。在这种情况下，通过 *蒙特卡洛方法* 所生成样本计算出的检验统计量的值和获得的临界区是非常有用的。蒙特卡洛方法是使用随机数的算法的通用名称，其名称源自于摩纳哥的蒙特卡洛赌场。基于蒙特卡洛方法的检验被称为 *蒙特卡洛检验* 。

为了通过蒙特卡洛检验来检验样本 <img src="http://latex.codecogs.com/gif.latex?\mathfrak{D}=\left\{x_1,\ldots,x_n\right\}" style="border:none;"> 的期望是否为 <img src="http://latex.codecogs.com/gif.latex?\mu" style="border:none;"> （在 <img src="http://latex.codecogs.com/gif.latex?10.2" style="border:none;"> 节中提到），使用 <img src="http://latex.codecogs.com/gif.latex?9.3.2" style="border:none;"> 节中引入的 bootstrap 方法。具体地，将 <img src="http://latex.codecogs.com/gif.latex?\mathfrak{D}=\left\{x_1,\ldots,x_n\right\}" style="border:none;"> 的 bootstrap 重采样和计算平均值重复多次，并构建平均值的直方图。然后，可以通过验证目标值 <img src="http://latex.codecogs.com/gif.latex?\mu" style="border:none;"> 是否包含在临界区中来近似地执行假设检验（如图10.1）。p-值也可以从直方图中近似获得。如上所述，基于 bootstrap 的假设检验具有高度通用性，可以应用于服从任意概率分布的样本中计算任意统计量。

在 <img src="http://latex.codecogs.com/gif.latex?10.4" style="border:none;"> 节介绍的列联表中，枚举所有可能的组合让我们能够获得任意检验统计量的概率分布。对于 <img src="http://latex.codecogs.com/gif.latex?2\times2" style="border:none;"> 列联表，通过穷尽的方法计算p-值称为 *Fisher 精确检验* 。在蒙特卡洛检验中，随机产生组合，并近似的进行检验。由于这允许我们在数值上近似任意大小的列联表及任意检验统计量的p-值，它可以被认为是 Fisher 精确检验的泛化。

为了检验原假设中 <img src="http://latex.codecogs.com/gif.latex?\mathfrak{D}=\left\{x_1,\ldots,x_n\right\}" style="border:none;"> 和 <img src="http://latex.codecogs.com/gif.latex?\mathfrak{{D}'}=\left\{{x}'_1,\ldots,{x}'_{{n}'}\right\}" style="border:none;"> 服从相同的概率分布，我们将所有样本 <img src="http://latex.codecogs.com/gif.latex?x_1,\ldots,x_n" style="border:none;"> 和 <img src="http://latex.codecogs.com/gif.latex?{x}'_1,\ldots,{x}'_{{n}'}" style="border:none;"> 合并在一起，并将它们分成大小为 <img src="http://latex.codecogs.com/gif.latex?n" style="border:none;"> 和 <img src="http://latex.codecogs.com/gif.latex?{n}'" style="border:none;"> 的两个集合。然后枚举所有可能使我们获得任意检验统计量的概率分布的分区。这被称为 *置换检验* ，而蒙特卡洛检验可以被认为是具有有限次重复的置换检验的近似实现。
